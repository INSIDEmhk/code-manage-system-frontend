<style scoped>
	.student-page {
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		width:637.5rpx;
		margin: auto; 
	}
	
	
	
	.header{
		padding-top:40rpx;
		display: flex;
		flex-direction: row;
		align-items: center;
		justify-content: center;
		width: 100%; 
		margin-bottom:-15rpx;
	}
	

	
	.text-area{
		width: 100%; 
		text-align: left; 
		padding-left: 20rpx; 
		font-size: 28rpx; 
		font-weight: bold; 
		margin-bottom: 0rpx; 
		display:flex;
		flex-direction:row;
	}
	
	.text{
		font-size:35rpx; 
		flex-grow: 1; /* å æ®å‰©ä½™ç©ºé—´ï¼Œè®©è¡Œå†…å‰©ä½™å…ƒç´ ç´§é å³ä¾§ */
	}
	
	
	
	.error-pop {
	    position: fixed;
		left: 20%; /* æ°´å¹³å±…ä¸­ */
	    top: -500rpx; /* é»˜è®¤éšè—åœ¨é¡¶éƒ¨ä»¥å¤– */
		width:60%;
	    background-color: #ff4d4f;
	    color: white;
	    font-size: 32rpx;
	    text-align: center;
	    line-height: 100rpx;
	    height: 100rpx;
	    z-index: 3000;
	    box-shadow: 0rpx 8rpx 12rpx rgba(0, 0, 0, 0.1);
	    transition: top 0.3s ease; 
		border-radius:20rpx;
	}
	
	.error-pop.active {
	    top: 105rpx; 
	}
	
	
	
	.ai-button {
		background-color: #007bff;
		color: white;
		width: 200rpx;
		height: 60rpx;
		border: none;
		border-radius: 15rpx;
		font-size: 28rpx;
		text-align: center;
		line-height: 60rpx;
		margin-top: 0rpx;
		margin-bottom:0rpx;
		cursor: pointer;
		margin-right: 0;
		transform: translate(-5rpx, -38rpx);
	}
	
	.ai-button1 {
		background-color: #007bff;
		color: white;
		width: 200rpx;
		height: 60rpx;
		border: none;
		border-radius: 15rpx;
		font-size: 28rpx;
		text-align: center;
		line-height: 60rpx;
		margin-top: 0rpx;
		margin-bottom:0rpx;
		cursor: pointer;
	}
	
	

	
	/* â€œè¿›è¡Œä¸­çš„è¯¾ç¨‹â€å±•ç¤ºåŒºåŸŸ */
	.enabled_courseList-section{
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		width:100%;
		height:360rpx;
		margin-bottom:40rpx;
		white-space: nowrap; 
		margin-top:20rpx;
	}

	.course-scroll{
		display: flex;
		flex-direction: row;
		overflow-x: auto; 
		white-space: nowrap; 
		padding: 10rpx; 
		width: 100%;
		height: 360rpx; 
		border: 1px solid gray;
	}
	
	.course-card{
		display: inline-block; /* é˜²æ­¢å¡ç‰‡è¢«æŒ¤å‹ï¼Œä¸åŠ ä¸Šä¼šå¯¼è‡´åªæ˜¾ç¤ºä¸€ä¸ªè¯¾ç¨‹å¡ç‰‡ */
		align-items: center;
		justify-content: center;
		width: 220rpx;
		height: 300rpx;
		background-color: #F0F0F0;
		border-radius: 15rpx;
		margin-right: 20rpx; 
		box-shadow: 0 2rpx 6rpx rgba(0, 0, 0, 0.1); 
		padding: 25rpx;
		margin-left:20rpx;
		text-align: center;
		/* animation: slideIn1 0.4s ease-out;  */
	}
	
	.course-image{
		width: 180rpx;
		height: 160rpx;
		background-color: #dcdcdc; 
		border-radius: 10rpx;
		margin-bottom: 10rpx;
		
	}
	
	.course-name{
		font-size: 24rpx;
		font-weight: bold;
		color: #333333;
		margin-bottom: 5rpx;
	}
	
	.course-date{
		font-size: 20rpx;
		color: #666666;
	}
	
	
	
	
	

	/* â€œå¾…æäº¤çš„ä½œä¸šâ€å±•ç¤ºåŒºåŸŸ */
	.unfinished_studentJobList-section{
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		border: 1px solid gray;
		border-radius: 20rpx;
		width:100%;
		margin-top:20rpx;
		height:auto;
		min-height:200rpx;
		margin-bottom:20rpx;
	}
	
	.job-card {
	  width: 90%; 
	  background-color: #f9f9f9;
	  border-radius: 15rpx;
	  padding: 20rpx;
	  margin-bottom: 20rpx;
	  box-shadow: 0 2rpx 6rpx rgba(0, 0, 0, 0.1); 
	  /* animation: slideIn 0.4s ease-out;  */
	}
	
	.job-title {
	  font-size: 30rpx;
	  font-weight: bold;
	  margin-bottom: 10rpx;
	}
	
	.job-content {
	  font-size: 26rpx;
	  color: #666666;
	  margin-bottom: 10rpx;
	}
	
	.job-date {
	  font-size: 24rpx;
	  color: #999999;
	}






	/* â€œç­›é€‰â€æŒ‰é’® */
	.select-button{
		width:180rpx;
		height:50rpx;
		cursor: pointer; 
		/* (urlåæœŸéœ€è¦ä¿®æ”¹ï¼ï¼ï¼) */
	    background-image: url('/static/select_button.png'); 
	    background-size: cover;
	    background-position: center; 
		border:1px solid transparent;
		outline: none; 
	}
	
	.select-button:after{
		border: none; 
	}
	
	
	
	
	
	
	/* ä¾§é¢å¼¹çª— */
	.sidebar-overlay {
	    position: fixed;
	    top: 0;
	    left: 0;
	    width: 100%;
	    height: 100%;
	    background-color: rgba(0, 0, 0, 0.3);
	    z-index: 1000;
	    display: none; /* é»˜è®¤éšè— */
	    opacity: 0;
	    transition: opacity 0.3s ease;
		z-index: 2000; /* æé«˜é®ç½©å±‚çš„å±‚çº§ */
	}
	
	.sidebar-overlay.show {
	    display: block;
	    opacity: 1;
	}
	
	.sidebar {
	    position: fixed;
	    top: 0;
	    right: -80%; 
	    width: 67%; 
	    height: 100%;
	    background-color: #ffffff;
	    z-index: 1001;
	    box-shadow: -4px 0 8px rgba(0, 0, 0, 0.2);
	    transition: right 0.3s ease;
		border-radius:30rpx;
		z-index: 3000; /* ä¾§è¾¹å¼¹çª— z-index è®¾ç½®è¾ƒé«˜ */
	}
	
	.sidebar.show {
	    right: 0;
	}
	
	.sidebar-header {
	    padding: 20px;
	    font-size: 18px;
	    font-weight: bold;
	    color: #333333;
	    border-bottom: 1px solid #dddddd;
	}
	
	.sidebar-content {
	    padding: 20px;
	    font-size: 16px;
	    color: #555555;
	}
	
	.sidebar-footer {
		display: flex;
		justify-content: space-around;
		padding: 20rpx;
		border-top: 1px solid #ddd;
		background-color: #f9f9f9;
	}
	
	.reset-button,
	.confirm-button {
		width: 200rpx;
		height: 60rpx;
		border: none;
		border-radius: 10rpx;
		font-size: 28rpx;
		cursor: pointer;
		text-align: center;
		line-height: 60rpx;
	}
	
	.reset-button {
		background-color: #f44336; /* çº¢è‰²èƒŒæ™¯ */
		color: white;
	}
	
	.confirm-button {
		background-color: #4caf50; /* ç»¿è‰²èƒŒæ™¯ */
		color: white;
	}
	
	
	
	
	
	
	/* è¯¾ç¨‹æŒ‰é’®æ ·å¼ */
	.course-item {
	  display: inline-block;
	  padding: 10rpx 20rpx;
	  margin: 10rpx;
	  border: 1px solid #ccc;
	  border-radius: 30rpx; /* åœ†è§’æ ·å¼ */
	  background-color: #f5f5f5;
	  color: #333;
	  font-size: 28rpx;
	  text-align: center;
	  cursor: pointer;
	  transition: all 0.3s ease;
	}
	
	.course-item.selected {
	  background-color: #007bff; /* é€‰ä¸­åçš„èƒŒæ™¯è‰² */
	  color: white; /* é€‰ä¸­åçš„æ–‡å­—é¢œè‰² */
	  border-color: #007bff;
	}
	
	
	
	/* åŠ¨ç”»ï¼šæ»‘å…¥ */
	@keyframes slideIn {
	  0% {
	    transform: translateY(-50rpx);
	    opacity: 0;
	  }
	  100% {
	    transform: translateY(0);
	    opacity: 1;
	  }
	}
	@keyframes slideIn1 {
	  0% {
	    transform: translateX(-30rpx);
	    opacity: 0;
	  }
	  100% {
	    transform: translateX(0);
	    opacity: 1;
	  }
	}
	
	
	
	
	
	/* åº•éƒ¨çš„å¯¼èˆªæ  */
	.footer-blank{
		height: 100rpx;
	}
	
	.footer {
	  display: flex;
	  flex-direction: row;
	  align-items: center;
	  justify-content: space-around;
	  position: fixed; 
	  bottom: 0rpx;
	  left: 0;
	  width: 100%;
	  height: 100rpx;
	  background-color: #f9f9f9;
	  border-top: 1px solid #e0e0e0;
	  box-shadow: 0 -2rpx 4rpx rgba(0, 0, 0, 0.1);
	  z-index: 1000;
	}
	
	.footer-item {
	  display: flex;
	  flex-direction: column;
	  align-items: center;
	  justify-content: center;
	  flex: 1;
	  color: #666666;
	  font-size: 28rpx;
	}
	
	.footer-item .icon {
	  font-size: 36rpx;
	  margin-bottom: 5rpx;
	}
	
	.footer-item .text {
	  font-size: 24rpx;
	}
	
	
	
	
	
	
	/* ç¡®è®¤é¡µé¢ */
	.modal-overlay {
		position: fixed;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		background-color: rgba(0, 0, 0, 0.5);
		display: flex;
		align-items: center;
		justify-content: center;
		z-index: 2000; /* ä¿è¯é®ç½©å±‚çš„ z-index æ¯”åº•éƒ¨å¯¼èˆªæ é«˜ */
	}
	
	.modal-content {
		width: 80%;
		background-color: white;
		border-radius: 10rpx;
		padding: 30rpx;
		text-align: center;
		box-shadow: 0 4rpx 8rpx rgba(0, 0, 0, 0.2);
	}
	
	.modal-content1 {
		width: 80%;
		background-color: white;
		border-radius: 10rpx;
		padding: 30rpx;
		text-align: center;
		box-shadow: 0 4rpx 8rpx rgba(0, 0, 0, 0.2);
		animation: slideIn1 0.4s ease-out; /* ä½¿ç”¨åŠ¨ç”» */
	}
	
	.modal-buttons {
		display: flex;
		justify-content: space-around;
		margin-top: 35rpx;
	}
	
	.modal-button {
		width: 120rpx;
		height: 60rpx;
		border-radius: 10rpx;
		font-size: 28rpx;
		text-align: center;
		line-height: 60rpx;
		cursor: pointer;
	}
	
	.cancel-button {
		background-color: black;
		color: white;
		width: 200rpx;
/* 		margin-right:10rpx;
		margin-bottom:100rpx; */
	}
	
	.info-label1 {
		font-size: 34rpx;
		margin-bottom: 40rpx;
		margin-top:-50rpx;
		display: flex; 
		justify-content: center ;
		color:red;
	}

	
	.info-label {
		font-size: 28rpx;
		margin-bottom: 10rpx;
		display: flex; 
		justify-content: flex-start; /* å·¦å¯¹é½ */
	}
	
	
	.info-input3 {
	  width: 95%;            /* å®½åº¦è‡ªé€‚åº”çˆ¶å®¹å™¨ */
	  height: 250rpx;          /* åˆå§‹é«˜åº¦ */
	  padding: 10rpx;          /* å†…è¾¹è·ï¼Œé¿å…æ–‡æœ¬ç´§è´´è¾¹ç¼˜ */
	  border-radius: 10rpx;     /* åœ†è§’è¾¹æ¡† */
	  font-size: 28rpx;        /* å­—ä½“å¤§å° */
	  line-height: 1.6;       /* è¡Œé«˜ */
	  overflow-y: auto;       /* è¶…è¿‡å†…å®¹æ—¶è‡ªåŠ¨æ˜¾ç¤ºçºµå‘æ»šåŠ¨æ¡ */
	  border:1px solid gray;
	  margin-bottom: 60rpx;
	  text-align: left;
	}
	
	
	.info-input2 {
	  width: 95%;            /* å®½åº¦è‡ªé€‚åº”çˆ¶å®¹å™¨ */
	  height: 100rpx;          /* åˆå§‹é«˜åº¦ */
	  padding: 10rpx;          /* å†…è¾¹è·ï¼Œé¿å…æ–‡æœ¬ç´§è´´è¾¹ç¼˜ */
	  border-radius: 10rpx;     /* åœ†è§’è¾¹æ¡† */
	  font-size: 28rpx;        /* å­—ä½“å¤§å° */
	  line-height: 1.6;       /* è¡Œé«˜ */
	  overflow-y: auto;       /* è¶…è¿‡å†…å®¹æ—¶è‡ªåŠ¨æ˜¾ç¤ºçºµå‘æ»šåŠ¨æ¡ */
	  border:1px solid gray;
	  margin-bottom: 60rpx;
	  text-align: left;
	}
	
	
	.info-input1 {
		width: 95%;
		padding: 10rpx;
		font-size: 28rpx;
		border-radius: 10rpx;
		/* margin:auto; */
		margin-bottom: 60rpx;
		margin-top:15rpx;
		border:1px solid gray;
		text-align: left;
	}
	
	.info-input {
		width: 95%;
		height: 38rpx; /* è®¾ç½®è¾“å…¥æ¡†çš„é«˜åº¦ */
		/* min-height:0rpx; */
		padding: 10rpx;
		font-size: 28rpx;
		border-radius: 10rpx;
		margin-bottom: 20rpx;
		border:1px solid lightgray;
		margin-top:15rpx;
		margin-bottom:60rpx;
		text-align: left;
	}
	
	/* è®©å¹´æœˆæ—¥ä¸‰ä¸ªè¾“å…¥æ¡†å‡ºç°åœ¨åŒä¸€è¡Œ */
	.flex-row {
		display: flex;
		justify-content: space-between; /* æˆ–ä½¿ç”¨ space-aroundã€center ç­‰æ¥æ§åˆ¶é—´è· */
	}
	
	
	
	
	/* ä»ä¸Šåˆ°ä¸‹æ»‘å…¥ */
	@keyframes slideIn {
		0% {
			transform: translateY(-20rpx);  
			opacity: 0;  
		}
		100% {
			transform: translateY(0);  
			opacity: 1;  
		}
	}
	@keyframes slideIn1 {
	    0% {
	        transform: translateY(-80rpx); 
	        opacity: 0;
	    }
	    100% {
	        transform: translateY(0); 
	        opacity: 1;
	    }
	}
</style>






<template>
	<view class="student-page">
		<view class="error-pop" :class="{ active: this.errorMessage }" :style="{ backgroundColor: errorPopBackgroundColor }">{{ this.errorMessage }}</view>
		
		
		
		
		<!-- ä¾§é¢å¼¹çª— -->
		<view class="sidebar-overlay" :class="{ 'show': isSidebarVisible }" @click="closeSidebar"></view>
		<view class="sidebar" :class="{ 'show': isSidebarVisible }">
		    <view class="sidebar-header">
		        <text>ç­›é€‰è¯¾ç¨‹ä½œä¸š</text>
		    </view>
		    <view class="sidebar-content">
				    <view 
					   class="course-item" 
					   v-for="course in enabled_courseList" 
					   :key="course.courseId" 
					   :class="{ selected: selected_enabled_courseList_temp.some(item => item.courseId === course.courseId) }"
					   @click="toggleCourseSelection(course)"
				    >
		            {{ course.name }}
		       </view>   
		    </view>
		    <view class="sidebar-footer">
				<button class="confirm-button" @click="confirmSelection">ä¿å­˜</button>
		        <button class="reset-button" @click="resetSelection">é‡ç½®</button>
		    </view>
		</view>
		
		
		
		<view class="header">
		    <text class="text">ä½ å¥½ï¼ <text style="font-weight: bold;"  v-if="studentInf && studentInf[0] && !studentInf[1]" >{{ this.studentInf[0].name }}</text> åŒå­¦</text>
		</view>
		
		
		
		
		
		
		
		
		
		<button class="ai-button" @click="openAskAiModal" >AIè§£ç­”</button>
		
		
		<!-- aiå¼¹çª— -->
		<view v-if="showAskAiModal" class="modal-overlay"  v-show="modalVisible">
		  <view class="modal-content1">

			  
			  
		    <text class="info-label">å½“å‰å­¦ç”Ÿç«¯å·²æ¥å…¥kimiæ™ºèƒ½åŠ©æ‰‹^_^</text>
		    <textarea class="info-input2" v-model="question" placeholder="è¯·è¾“å…¥è¦è¯¢é—®çš„é—®é¢˜" />
			
			<text class="info-label1" v-if="asking">kimiæ­£åœ¨æ€è€ƒä¸­...</text>
			

			
			<text class="info-label">aiè§£ç­”ï¼š</text>
			<textarea class="info-input3" v-model="answer" placeholder="kimiåŠ©æ‰‹å°†å›ç­”æ‚¨çš„é—®é¢˜" :disabled="true"/>
		
			
			<view class="modal-buttons">
				<button class="ai-button1"   @click="askAiRequest">å‘é€é—®é¢˜</button>
				<button class="modal-button cancel-button"   @click="closeAskAiModal">é€€å‡ºé—®ç­”</button>	
				
			</view>

		  </view>
		</view>
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		<view class="text-area">
			<text class="text">è¿›è¡Œä¸­çš„è¯¾ç¨‹ç­çº§</text>
		</view>
		
		<view class="enabled_courseList-section">
			<scroll-view class="course-scroll" scroll-x>
			    <view class="course-card"  v-for="course in enabled_courseList"  :key="course.courseId"   @click="goToCourseDetail(course.classId)">
			        <image class="course-image" />
			        <view class="course-name">{{ course.name }}</view>
					<text class="course-date">ç­çº§ç¼–å·ï¼š{{course.classId}} </text>
					<br>
					<text class="course-date">è¯¾ç¨‹ç¼–å·ï¼š{{ course.courseId }}&nbsp;&nbsp;&nbsp;&nbsp;</text>
			    </view>
			</scroll-view>
		</view>
		
		
		
		
		<view class="text-area">
			<text class="text">è¿›è¡Œä¸­çš„ä½œä¸š</text>
			<button @click="openSidebar" class="select-button"></button>
		</view>
		<view class="unfinished_studentJobList-section">
			<view class="job-card" v-for="job in selected_unfinished_studentJobList" :key="job.jobId" @click="goToJobDetail(job.jobId)">
				<view class="job-title">{{ job.title }}</view>
				<view class="job-content">{{ job.content }}</view>
				<view class="job-date">{{ formatDate(job.startTime) }} - {{  formatDate(job.endTime) }}</view>
			  </view>
		</view>
		
		
		
		<!-- åº•éƒ¨å¯¼èˆªæ ï¼ˆæ·»åŠ ä¸€æ®µç©ºç™½æŒ¤å ç©ºé—´ï¼Œé˜²æ­¢footeråº•éƒ¨å¯¼èˆªæ é®æŒ¡ä½æœ€ä¸‹é¢çš„ä½œä¸šï¼‰ -->
		<view class="footer-blank"></view>
		<view class="footer">
			<view class="footer-item" @click="goToHome">
				<view class="icon">ğŸ </view>
				<view class="text" style="color:#ff4d4f">é¦–é¡µ</view>
			</view>
			<view class="footer-item" @click="goToCourses">
				<view class="icon">ğŸ“˜</view>
				<view class="text">è¯¾ç¨‹</view>
			</view>
			<view class="footer-item" @click="goToProfile">
				<view class="icon">ğŸ‘¤</view>
				<view class="text">æˆ‘çš„</view>
			</view>
		</view>
	</view>
</template>






<script>
	import { config } from '../../../config'; // å¯¼å…¥ config.js æ–‡ä»¶
	
	
	export default {
		data() {
			return {
				apiUrl: `http://${config.host}:${config.port}`, // ä½¿ç”¨é…ç½®çš„hostå’Œport
				pyapiUrl: `http://${config.host}:${config.pyport}`, // ä½¿ç”¨é…ç½®çš„hostå’Œport
				
				who:"",
				
				
				
				isAiPopupVisible: false, // æ§åˆ¶ AI å¼¹çª—çš„æ˜¾ç¤ºä¸éšè—
				
				
				
				// å­¦ç”Ÿç”¨æˆ·è¦é—®aiçš„é—®é¢˜
				question:"",
				// aiçš„è§£ç­”
				answer:"",
				
				asking:false,
				
				
				// é”™è¯¯å¼¹çª—æç¤ºä¿¡æ¯
				errorMessage: '',
				errorPopBackgroundColor: '#ff4d4f', // é”™è¯¯å¼¹çª—èƒŒæ™¯é¢œè‰²
				timeoutId: null,
				
				// ä¾§é¢å¼¹çª—
				isSidebarVisible: false, 
				
				
				// å­¦ç”ŸåŸºæœ¬ä¿¡æ¯,ä»åç«¯æœåŠ¡å™¨è·å–
				studentInf:"",
		
		
				// â€œè¿›è¡Œä¸­çš„è¯¾ç¨‹â€
				enabled_courseList:"",
				// â€œå¾…æäº¤çš„ä½œä¸šâ€
				unfinished_studentJobList:"",
				
				
				// ç­›é€‰è¯¾ç¨‹
				selected_enabled_courseList:[],
				selected_enabled_courseList_temp:[],
				// ç­›é€‰è¯¾ç¨‹çš„ä½œä¸š
				selected_unfinished_studentJobList:[],
				
				
				
				showAskAiModal: false,
				modalVisible: true, 
			};
		},
	  
	  
	  
	  
	  
	  
		onLoad(query) {
			console.log(query.id);
			this.who=query.id;
			
			
			if(!this.who){
				// console.log('Debug: this.who is', this.who); 
				this.showError("è¯·å…ˆç™»å½•ï¼");
				uni.reLaunch({
					// (urlåæœŸéœ€è¦ä¿®æ”¹ï¼ï¼ï¼)
				    url: "/pages/index/login"
				});
				return;
			}
			
			
			this.load_studentInf(); 
			this.load_enabled_courseList();
			this.load_unfinished_studentJobList();
		},
	  
	  
	  
	  
	  
	  
		methods: {
			openAskAiModal(){
				this.showAskAiModal=true;
			},
			
			closeAskAiModal(){
				this.showAskAiModal=false;
				this.question="";
				this.answer="";
			},
			
			
			askAiRequest(){
				this.answer="",
				this.asking=true;
				uni.showLoading({
				    title: 'æ­£åœ¨æ€è€ƒä¸­...', // åŠ è½½åŠ¨ç”»çš„æç¤ºæ–‡å­—
				    mask: true // é˜»æ­¢ç‚¹å‡»èƒŒæ™¯æ—¶å…³é—­åŠ è½½æç¤º
				});
				uni.request({
					url: `${this.pyapiUrl}/api/aiChat`, 
					method: 'POST',
					data:{
						text:this.question
					},
					success: (res) => {
						 // console.log(res);
						if (res.data.data === '000') {
							this.answer=res.data.text;
						} 
						else {
							this.showError("ç½‘ç»œç¹å¿™ï¼Œè¯·ç¨åå†è¯•"); // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
						}
					},
					fail: () => {
						this.showError("ç½‘ç»œç¹å¿™ï¼Œè¯·ç¨åå†è¯•");
					},
					complete: () => {
						this.asking=false;
						uni.hideLoading();
					}
				});
			},
			  
			  
			  
			  
			// é¡¶éƒ¨å¼¹çª—
			showError(message, color = "#ff4d4f") {
				this.errorMessage = message; // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
				this.errorPopBackgroundColor = color; // è®¾ç½®å¼¹çª—èƒŒæ™¯è‰²
				if (this.timeoutId) {
					clearTimeout(this.timeoutId); // æ¸…é™¤ä¹‹å‰çš„å®šæ—¶å™¨
				}
				this.timeoutId = setTimeout(() => {
					this.errorMessage = ""; // éšè—é”™è¯¯ä¿¡æ¯
					this.timeoutId = null; // æ¸…é™¤å®šæ—¶å™¨
				}, 1200); // 1.2ç§’åéšè—é”™è¯¯ä¿¡æ¯
			},
			
			
			
			formatDate(date) {
			    // å¦‚æœè¾“å…¥çš„æ˜¯æ—¥æœŸå­—ç¬¦ä¸²ï¼Œè½¬æ¢ä¸º Date å¯¹è±¡
			    if (typeof date === 'string') {
			        date = new Date(date);
			    }
			
			    // è·å–å¹´ä»½ã€æœˆä»½ã€æ—¥æœŸ
			    const year = date.getFullYear();
			    const month = (date.getMonth() + 1).toString().padStart(2, '0'); // æœˆä»½ä» 0 å¼€å§‹ï¼Œæ‰€ä»¥åŠ  1
			    const day = date.getDate().toString().padStart(2, '0'); // ç¡®ä¿æ—¥æœŸæ˜¯ä¸¤ä½æ•°
			
			    // è¿”å›æ ¼å¼åŒ–åçš„å­—ç¬¦ä¸²
			    return `${year}-${month}-${day}`;
			},
			
			
			// ä¾§é¢å¼¹çª—çš„æ˜¾ç¤ºå’Œéšè—
		    openSidebar() {
				this.selected_enabled_courseList_temp = [...this.selected_enabled_courseList];
		        this.isSidebarVisible = true;
		    },
		    closeSidebar() {
				this.selected_enabled_courseList_temp = [...this.selected_enabled_courseList];
		        this.isSidebarVisible = false; 
		    },	
			
			// ä¾§é¢å¼¹çª—é‡Œçš„è¯¾ç¨‹æŒ‰é’®ï¼Œç‚¹å‡»äº†å°±å˜ä¸ºè“è‰²è¡¨ç¤ºç­›é€‰è¯¥è¯¾ç¨‹
			toggleCourseSelection(course) {
				const index = this.selected_enabled_courseList_temp.findIndex(item => item.classId === course.classId);
				if (index !== -1) {
					this.selected_enabled_courseList_temp.splice(index, 1);
				} else {
					this.selected_enabled_courseList_temp.push(course);
				}
			},
			
			// ä¾§é¢å¼¹çª—çš„â€œä¿å­˜â€æŒ‰é’®
			confirmSelection() {
				this.selected_enabled_courseList = [...this.selected_enabled_courseList_temp];
			    const selectedCourseIds = new Set(this.selected_enabled_courseList.map(course => course.classId));
			    this.selected_unfinished_studentJobList = this.unfinished_studentJobList.filter(job =>
			        selectedCourseIds.has(job.classId)
			    );	
			    this.closeSidebar();
			},
			
			// ä¾§é¢å¼¹çª—çš„â€œé‡ç½®â€æŒ‰é’®
			resetSelection() {
				// é‡ç½®ä¾§é¢å¼¹çª—çš„è¯¾ç¨‹ç­›é€‰åˆ—è¡¨
				this.selected_enabled_courseList = [...this.enabled_courseList];
				this.selected_enabled_courseList_temp = [...this.selected_enabled_courseList];
				// é‡ç½®ä¸»é¡µçš„ä½œä¸šç­›é€‰åˆ—è¡¨
				this.selected_unfinished_studentJobList = [...this.unfinished_studentJobList];
			},
			
			
			
			

			
			// è·å–å­¦ç”Ÿçš„åŸºæœ¬ä¿¡æ¯
			load_studentInf() {
				// if(!this.who){
				// 	// console.log('Debug: this.who is', this.who); 
				// 	this.showError("ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åå†è¯•");
				// 	return;
				// }
				uni.request({
					url: `${this.apiUrl}/api/queryStudentByFactor`, 
					method: 'POST',
					data:{
						"studentId": this.who
					},
					success: (res) => {
						 // console.log(res);
						if (res.data.code === '000') {
							this.studentInf=res.data.data;
						} 
						else {
							this.showError(res.data.info); // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
						}
					},
					fail: () => {
						this.showError("ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åå†è¯•");
					}
				});
			},
			
			// åˆå§‹åŒ–è¯¾ç¨‹åˆ—è¡¨
			load_enabled_courseList() {
				// if(!this.who){
				// 	// console.log('Debug: this.who is', this.who); 
				// 	this.showError("ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åå†è¯•");
				// 	return;
				// }
				uni.request({
					url: `${this.apiUrl}/api/queryClassByStudentId?studentId=${this.who}`,
					method: 'GET',
					success: (res) => {
						 // console.log(res);
						if (res.data.code === '000') {
							this.enabled_courseList = res.data.data;
							this.load_selected_enabled_courseList();
						} 
						else {
							this.showError(res.data.info); // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
						}
					},
					fail: () => {
						this.showError("ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åå†è¯•");
					}
				});
			},
			
			
			// åˆå§‹åŒ–ç­›é€‰çš„è¯¾ç¨‹åˆ—è¡¨
			load_selected_enabled_courseList() {
				this.selected_enabled_courseList = [...this.enabled_courseList];
			},
			
			
			// åˆå§‹åŒ–ä½œä¸šåˆ—è¡¨
			load_unfinished_studentJobList() {
				// if(!this.who){
				// 	// console.log('Debug: this.who is', this.who); 
				// 	this.showError("ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åå†è¯•");
				// 	return;
				// }
				uni.request({
					url: `${this.apiUrl}/student/queryJobByStudentJobFactor`, 
					method: 'POST',
					data:{
						jobId: "",
						studentId: this.who,
						status: ""
					},
					success: (res) => {
						 // console.log(res);
						if (res.data.code === '000') {
							this.unfinished_studentJobList = res.data.data;
							this.load_selected_unfinished_studentJobList();
						} 
						else {
							this.showError(res.data.info); // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
						}
					},
					fail: () => {
						this.showError("ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åå†è¯•");
					}
				});
			},
			
			
			// åˆå§‹åŒ–ç­›é€‰çš„è¯¾ç¨‹çš„è¯¾ç¨‹çš„ä½œä¸šåˆ—è¡¨
			load_selected_unfinished_studentJobList() {
				this.selected_unfinished_studentJobList= [...this.unfinished_studentJobList];
			},
			
			
			
			goToJobDetail(jobId) {
				uni.navigateTo({
					url: `/pages/index/student/jobDetail?jobId=${jobId}&id=${this.who}`  
				});
			},
			
			
			goToCourseDetail(classId) {
				uni.navigateTo({
					url: `/pages/index/student/courseDetail?classId=${classId}&id=${this.who}`  
				});
			},
			
			
			// åº•éƒ¨å¯¼èˆªæ æŒ‰é’®
			// goToHome() {
			// 	uni.pageScrollTo({
			// 		scrollTop: 0, // æ»šåŠ¨åˆ°é¡µé¢é¡¶éƒ¨
			// 		duration: 500, // æ»šåŠ¨åŠ¨ç”»çš„æŒç»­æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
			// 	});
			// },
			// goToCourses() {
			// 	uni.redirectTo({
			// 		url: `/pages/index/student/student2?id=${this.who}`  // æ·»åŠ  id å‚æ•°
			// 	});

			// },
			// goToProfile() {
			// 	uni.redirectTo({
			// 		url: `/pages/index/student/student3?id=${this.who}`  // æ·»åŠ  id å‚æ•°
			// 	});

			// },
			
			// åº•éƒ¨ç‚¹å‡»å¯¼èˆªæ æŒ‰é’®åˆ‡æ¢é¡µé¢
			goToHome() {
				uni.pageScrollTo({
					scrollTop: 0, // æ»šåŠ¨åˆ°é¡µé¢é¡¶éƒ¨
					duration: 500, // æ»šåŠ¨åŠ¨ç”»çš„æŒç»­æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
				});
			
			},
			goToCourses() {
				if(this.who){
					uni.redirectTo({
						url: `/pages/index/student/student2?id=${this.who}`  // æ·»åŠ  id å‚æ•°
					});
				}
				else{
					uni.reLaunch({
						url: "/pages/index/student/student2"
					});
				}
			},
			goToProfile() {
				if(this.who){
					uni.redirectTo({
						url: `/pages/index/student/student3?id=${this.who}`  // æ·»åŠ  id å‚æ•°
					});
				}
				else{
					uni.reLaunch({
						url: "/pages/index/student/student3"
					});
				}
			},
			
			
			
			
			
		},
	};
</script>